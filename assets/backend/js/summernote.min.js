(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(window.jQuery)}}(function(g){if("function"!==typeof Array.prototype.reduce){Array.prototype.reduce=function(E,D){var z,B,A=this.length>>>0,C=false;if(1<arguments.length){B=D;C=true}for(z=0;A>z;++z){if(this.hasOwnProperty(z)){if(C){B=E(B,this[z],z,this)}else{B=this[z];C=true}}}if(!C){throw new TypeError("Reduce of empty array with no initial value")}return B}}var f=typeof define==="function"&&define.amd;var n=function(B){var D=B==="Comic Sans MS"?"Courier New":"Comic Sans MS";var z=g("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body);var C=z.css("fontFamily",D).width();var A=z.css("fontFamily",B+","+D).width();z.remove();return C!==A};var b={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1,isFF:navigator.userAgent.indexOf("Firefox")>-1,jqueryVersion:parseFloat(g.fn.jquery),isSupportAmd:f,hasCodeMirror:f?require.specified("CodeMirror"):!!window.CodeMirror,isFontInstalled:n};var j=(function(){var I=function(J){return function(K){return J===K}};var E=function(K,J){return K===J};var G=function(){return true};var B=function(){return false};var A=function(J){return function(){return !J.apply(J,arguments)}};var H=function(J){return J};var C=0;var F=function(J){var K=++C+"";return J?J+K:K};var z=function(J){var K=g(document);return{top:J.top+K.scrollTop(),left:J.left+K.scrollLeft(),width:J.right-J.left,height:J.bottom-J.top}};var D=function(L){var J={};for(var K in L){if(L.hasOwnProperty(K)){J[L[K]]=K}}return J};return{eq:I,eq2:E,ok:G,fail:B,not:A,self:H,uniqueId:F,rect2bnd:z,invertObject:D}})();var w=(function(){var G=function(J){return J[0]};var I=function(J){return J[J.length-1]};var D=function(J){return J.slice(0,J.length-1)};var E=function(J){return J.slice(1)};var B=function(L,K){var J=L.indexOf(K);if(J===-1){return null}return L[J+1]};var z=function(L,K){var J=L.indexOf(K);if(J===-1){return null}return L[J-1]};var C=function(K,J){J=J||j.self;return K.reduce(function(M,L){return M+J(L)},0)};var H=function(M){var K=[],J=-1,L=M.length;while(++J<L){K[J]=M[J]}return K};var A=function(L,J){if(!L.length){return[]}var K=E(L);return K.reduce(function(O,N){var M=I(O);if(J(I(M),N)){M[M.length]=N}else{O[O.length]=[N]}return O},[[G(L)]])};var F=function(M){var L=[];for(var J=0,K=M.length;J<K;J++){if(M[J]){L.push(M[J])}}return L};return{head:G,last:I,initial:D,tail:E,prev:z,next:B,sum:C,from:H,compact:F,clusterBy:A}})();var t=(function(){var L=function(ab){return ab&&g(ab).hasClass("note-editable")};var O=function(ab){return ab&&g(ab).hasClass("note-control-sizing")};var X=function(ab){var ac;if(ab.hasClass("note-air-editor")){var ad=w.last(ab.attr("id").split("-"));ac=function(ae){return function(){return g(ae+ad)}};return{editor:function(){return ab},editable:function(){return ab},popover:ac("#note-popover-"),handle:ac("#note-handle-"),dialog:ac("#note-dialog-")}}else{ac=function(ae){return function(){return ab.find(ae)}};return{editor:function(){return ab},dropzone:ac(".note-dropzone"),toolbar:ac(".note-toolbar"),editable:ac(".note-editable"),codable:ac(".note-codable"),statusbar:ac(".note-statusbar"),popover:ac(".note-popover"),handle:ac(".note-handle"),dialog:ac(".note-dialog")}}};var A=function(ab){return function(ac){return ac&&ac.nodeName===ab}};var B=function(ab){return ab&&/^DIV|^P|^LI|^H[1-7]/.test(ab.nodeName)};var U=function(ab){return ab&&/^UL|^OL/.test(ab.nodeName)};var C=function(ab){return ab&&/^TD|^TH/.test(ab.nodeName)};var V=function(ac,ab){while(ac){if(ab(ac)){return ac}if(L(ac)){break}ac=ac.parentNode}return null};var aa=function(ad,ab){ab=ab||j.fail;var ac=[];V(ad,function(ae){ac.push(ae);return ab(ae)});return ac};var I=function(ad,ac){var ab=aa(ad);for(var ae=ac;ae;ae=ae.parentNode){if(g.inArray(ae,ab)>-1){return ae}}return null};var F=function(ag,ae){var ac=[];var ab=false,ad=false;(function af(ai){if(!ai){return}if(ai===ag){ab=true}if(ab&&!ad){ac.push(ai)}if(ai===ae){ad=true;return}for(var ah=0,aj=ai.childNodes.length;ah<aj;ah++){af(ai.childNodes[ah])}})(I(ag,ae));return ac};var G=function(ad,ac){ac=ac||j.fail;var ab=[];while(ad){ab.push(ad);if(ac(ad)){break}ad=ad.previousSibling}return ab};var H=function(ad,ac){ac=ac||j.fail;var ab=[];while(ad){ab.push(ad);if(ac(ad)){break}ad=ad.nextSibling}return ab};var W=function(ad,ab){var ac=[];ab=ab||j.ok;(function ae(ah){if(ad!==ah&&ab(ah)){ac.push(ah)}for(var af=0,ag=ah.childNodes.length;af<ag;af++){ae(ah.childNodes[af])}})(ad);return ac};var T=function(ae,ad){var ac=ad.nextSibling,ab=ad.parentNode;if(ac){ab.insertBefore(ae,ac)}else{ab.appendChild(ae)}return ae};var z=function(ab,ac){g.each(ac,function(ad,ae){ab.appendChild(ae)});return ab};var Q=A("#text");var E=function(ab){if(Q(ab)){return ab.nodeValue.length}return ab.childNodes.length};var N=function(ab){return ab.offset===0||ab.offset===E(ab.node)};var Z=function(ab){var ac=0;while((ab=ab.previousSibling)){ac+=1}return ac};var S=function(ab){return ab&&ab.childNodes&&ab.childNodes.length};var D=function(ac){var ab=ac.node,ad=ac.offset;if(ad===0){if(L(ab)){return null}return{node:ab.parentNode,offset:Z(ab)}}else{if(S(ab)){var ae=ab.childNodes[ad-1];return{node:ae,offset:E(ae)}}else{return{node:ab,offset:ad-1}}}};var J=function(ac,ad){var ab=w.initial(aa(ad,j.eq(ac)));return g.map(ab,Z).reverse()};var P=function(ac,ad){var af=ac;for(var ab=0,ae=ad.length;ab<ae;ab++){af=af.childNodes[ad[ab]]}return af};var R=function(ab,ac){if(ac===0){return ab}if(ac>=E(ab)){return ab.nextSibling}if(Q(ab)){return ab.splitText(ac)}var ad=ab.childNodes[ac];ab=T(ab.cloneNode(false),ab);return z(ab,H(ad))};var M=function(ac,ab,ae){var ad=aa(ab,j.eq(ac));if(ad.length===1){return R(ab,ae)}return ad.reduce(function(ag,af){var ah=af.cloneNode(false);T(ah,af);if(ag===ab){ag=R(ag,ae)}z(ah,H(ag));return ah})};var Y=function(af,ac){if(!af||!af.parentNode){return}if(af.removeNode){return af.removeNode(ac)}var ae=af.parentNode;if(!ac){var ab=[];var ad,ag;for(ad=0,ag=af.childNodes.length;ad<ag;ad++){ab.push(af.childNodes[ad])}for(ad=0,ag=ab.length;ad<ag;ad++){ae.insertBefore(ab[ad],af)}}ae.removeChild(af)};var K=function(ab){return t.isTextarea(ab[0])?ab.val():ab.html()};return{blank:b.isMSIE?"&nbsp;":"<br/>",emptyPara:"<p><br/></p>",isEditable:L,isControlSizing:O,buildLayoutInfo:X,isText:Q,isPara:B,isList:U,isTable:A("TABLE"),isCell:C,isAnchor:A("A"),isDiv:A("DIV"),isLi:A("LI"),isSpan:A("SPAN"),isB:A("B"),isU:A("U"),isS:A("S"),isI:A("I"),isImg:A("IMG"),isTextarea:A("TEXTAREA"),length:E,isEdgeBP:N,prevBP:D,ancestor:V,listAncestor:aa,listNext:H,listPrev:G,listDescendant:W,commonAncestor:I,listBetween:F,insertAfter:T,position:Z,makeOffsetPath:J,fromOffsetPath:P,splitTree:M,remove:Y,html:K}})();var x={version:"0.5.3",options:{width:null,height:null,minHeight:null,maxHeight:null,focus:false,tabsize:4,styleWithSpan:true,disableLinkTarget:false,disableDragAndDrop:false,disableResizeEditor:false,codemirror:{mode:"text/html",htmlMode:true,lineNumbers:true,autoFormatOnStart:false},lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","superscript","subscript","strikethrough","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","video","hr"]],["view",["fullscreen","codeview"]],["help",["help"]]],airMode:false,airPopover:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]],styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],defaultFontName:"Helvetica Neue",fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],fontSizes:["8","9","10","11","12","14","18","24","36"],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],insertTableMaxSize:{col:10,row:10},oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onToolbarClick:null,onCreateLink:function(z){if(z.indexOf("@")!==-1&&z.indexOf(":")===-1){z="mailto:"+z}else{if(z.indexOf("://")===-1){z="http://"+z}}return z},keyMap:{pc:{"CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"showLinkDialog"},mac:{"CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"showLinkDialog"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",clear:"Remove Font Style",height:"Line Height",name:"Font Family",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",dragImageHere:"Drag an image here",selectFromFiles:"Select from files",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style"},history:{undo:"Undo",redo:"Redo"}}}};var i=(function(){var z=function(B){return g.Deferred(function(C){g.extend(new FileReader(),{onload:function(E){var D=E.target.result;C.resolve(D)},onerror:function(){C.reject(this)}}).readAsDataURL(B)}).promise()};var A=function(B){return g.Deferred(function(C){g("<img>").one("load",function(){C.resolve(g(this))}).one("error abort",function(){C.reject(g(this))}).css({display:"none"}).appendTo(document.body).attr("src",B)}).promise()};return{readFileAsDataURL:z,createImage:A}})();var y={isEdit:function(z){return[8,9,13,32].indexOf(z)!==-1},nameFromCode:{"8":"BACKSPACE","9":"TAB","13":"ENTER","32":"SPACE","48":"NUM0","49":"NUM1","50":"NUM2","51":"NUM3","52":"NUM4","53":"NUM5","54":"NUM6","55":"NUM7","56":"NUM8","66":"B","69":"E","73":"I","74":"J","75":"K","76":"L","82":"R","83":"S","85":"U","89":"Y","90":"Z","191":"SLASH","219":"LEFTBRACKET","220":"BACKSLASH","221":"RIGHTBRACKET"}};var a=function(){var z=function(C,B){if(b.jqueryVersion<1.9){var A={};g.each(B,function(D,E){A[E]=C.css(E)});return A}return C.css.call(C,B)};this.stylePara=function(B,A){g.each(B.nodes(t.isPara),function(C,D){g(D).css(A)})};this.current=function(A,B){var G=g(t.isText(A.sc)?A.sc.parentNode:A.sc);var E=["font-family","font-size","text-align","list-style-type","line-height"];var H=z(G,E)||{};H["font-size"]=parseInt(H["font-size"],10);H["font-bold"]=document.queryCommandState("bold")?"bold":"normal";H["font-italic"]=document.queryCommandState("italic")?"italic":"normal";H["font-underline"]=document.queryCommandState("underline")?"underline":"normal";H["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal";H["font-superscript"]=document.queryCommandState("superscript")?"superscript":"normal";H["font-subscript"]=document.queryCommandState("subscript")?"subscript":"normal";if(!A.isOnList()){H["list-style"]="none"}else{var D=["circle","disc","disc-leading-zero","square"];var C=g.inArray(H["list-style-type"],D)>-1;H["list-style"]=C?"unordered":"ordered"}var I=t.ancestor(A.sc,t.isPara);if(I&&I.style["line-height"]){H["line-height"]=I.style.lineHeight}else{var F=parseInt(H["line-height"],10)/parseInt(H["font-size"],10);H["line-height"]=F.toFixed(1)}H.image=t.isImg(B)&&B;H.anchor=A.isOnAnchor()&&t.ancestor(A.sc,t.isAnchor);H.aAncestor=t.listAncestor(A.sc,t.isEditable);H.range=A;return H}};var m=(function(){var A=!!document.createRange;var C=function(N,D){var M=N.parentElement(),F;var L=document.body.createTextRange(),K;var I=w.from(M.childNodes);for(F=0;F<I.length;F++){if(t.isText(I[F])){continue}L.moveToElementText(I[F]);if(L.compareEndPoints("StartToStart",N)>=0){break}K=I[F]}if(F!==0&&t.isText(I[F-1])){var O=document.body.createTextRange(),J=null;O.moveToElementText(K||M);O.collapse(!K);J=K?K.nextSibling:M.firstChild;var E=N.duplicate();E.setEndPoint("StartToStart",O);var H=E.text.replace(/[\r\n]/g,"").length;while(H>J.nodeValue.length&&J.nextSibling){H-=J.nodeValue.length;J=J.nextSibling}var G=J.nodeValue;if(D&&J.nextSibling&&t.isText(J.nextSibling)&&H===J.nodeValue.length){H-=J.nodeValue.length;J=J.nextSibling}M=J;F=H}return{cont:M,offset:F}};var B=function(E){var G=function(L,M){var I,H;if(t.isText(L)){var J=t.listPrev(L,j.not(t.isText));var K=w.last(J).previousSibling;I=K||L.parentNode;M+=w.sum(w.tail(J),t.length);H=!K}else{I=L.childNodes[M]||L;if(t.isText(I)){return G(I,M)}M=0;H=false}return{cont:I,collapseToStart:H,offset:M}};var D=document.body.createTextRange();var F=G(E.cont,E.offset);D.moveToElementText(F.cont);D.collapse(F.collapseToStart);D.moveStart("character",F.offset);return D};var z=function(I,H,E,D){this.sc=I;this.so=H;this.ec=E;this.eo=D;var G=function(){if(A){var J=document.createRange();J.setStart(I,H);J.setEnd(E,D);return J}else{var K=B({cont:I,offset:H});K.setEndPoint("EndToEnd",B({cont:E,offset:D}));return K}};this.getBPs=function(){return{sc:I,so:H,ec:E,eo:D}};this.getStartBP=function(){return{node:I,offset:H}};this.getEndBP=function(){return{node:E,offset:D}};this.select=function(){var K=G();if(A){var J=document.getSelection();if(J.rangeCount>0){J.removeAllRanges()}J.addRange(K)}else{K.select()}};this.nodes=function(K){K=K||j.ok;var J=t.listBetween(I,E);var L=w.compact(g.map(J,function(M){return t.ancestor(M,K)}));return g.map(w.clusterBy(L,j.eq2),w.head)};this.commonAncestor=function(){return t.commonAncestor(I,E)};this.expand=function(J){var L=t.ancestor(I,J);var M=t.ancestor(E,J);if(!L&&!M){return new z(I,H,E,D)}var K=this.getBPs();if(L){K.sc=L;K.so=0}if(M){K.ec=M;K.eo=t.length(M)}return new z(K.sc,K.so,K.ec,K.eo)};this.collapse=function(J){if(J){return new z(I,H,I,H)}else{return new z(E,D,E,D)}};this.splitText=function(){var J=I===E;var K=this.getBPs();if(t.isText(E)&&!t.isEdgeBP(this.getEndBP())){E.splitText(D)}if(t.isText(I)&&!t.isEdgeBP(this.getStartBP())){K.sc=I.splitText(H);K.so=0;if(J){K.ec=K.sc;K.eo=D-H}}return new z(K.sc,K.so,K.ec,K.eo)};this.deleteContents=function(){if(this.isCollapsed()){return this}var J=this.splitText();var K=t.prevBP(J.getStartBP());g.each(J.nodes(),function(L,M){t.remove(M,!t.isPara(M))});return new z(K.node,K.offset,K.node,K.offset)};var F=function(J){return function(){var K=t.ancestor(I,J);return !!K&&(K===t.ancestor(E,J))}};this.isOnEditable=F(t.isEditable);this.isOnList=F(t.isList);this.isOnAnchor=F(t.isAnchor);this.isOnCell=F(t.isCell);this.isCollapsed=function(){return I===E&&H===D};this.insertNode=function(J){var K=G();if(A){K.insertNode(J)}else{var L="node-insert-node-target";J.id=L;K.pasteHTML(J.outerHTML);J=g("#"+L)[0]}return J};this.toString=function(){var J=G();return A?J.toString():J.text};this.bookmark=function(J){return{s:{path:t.makeOffsetPath(J,I),offset:H},e:{path:t.makeOffsetPath(J,E),offset:D}}};this.getClientRects=function(){var J=G();return J.getClientRects()}};return{create:function(J,E,H,D){if(!arguments.length){if(A){var L=document.getSelection();if(L.rangeCount===0){return null}var K=L.getRangeAt(0);J=K.startContainer;E=K.startOffset;H=K.endContainer;D=K.endOffset}else{var N=document.selection.createRange();var F=N.duplicate();F.collapse(false);var M=N;M.collapse(true);var G=C(M,true),I=C(F,false);J=G.cont;E=G.offset;H=I.cont;D=I.offset}}else{if(arguments.length===2){H=J;D=E}}return new z(J,E,H,D)},createFromNode:function(D){return this.create(D,0,D,1)},createFromBookmark:function(F,G){var I=t.fromOffsetPath(F,G.s.path);var H=G.s.offset;var E=t.fromOffsetPath(F,G.e.path);var D=G.e.offset;return new z(I,H,E,D)}}})();var e=function(){this.tab=function(A,B){var E=t.ancestor(A.commonAncestor(),t.isCell);var C=t.ancestor(E,t.isTable);var D=t.listDescendant(C,t.isCell);var z=w[B?"prev":"next"](D,E);if(z){m.create(z,0).select()}};this.createTable=function(E,C){var G=[],F;for(var D=0;D<E;D++){G.push("<td>"+t.blank+"</td>")}F=G.join("");var B=[],z;for(var A=0;A<C;A++){B.push("<tr>"+F+"</tr>")}z=B.join("");var H='<table class="table table-bordered">'+z+"</table>";return g(H)[0]}};var p=function(){var B=new a();var D=new e();this.saveRange=function(G){G.focus();G.data("range",m.create())};this.restoreRange=function(H){var G=H.data("range");if(G){G.select();H.focus()}};this.currentStyle=function(H){var G=m.create();return G?G.isOnEditable()&&B.current(G,H):false};this.undo=function(G){G.data("NoteHistory").undo(G)};this.redo=function(G){G.data("NoteHistory").redo(G)};var C=this.recordUndo=function(G){G.data("NoteHistory").recordUndo(G)};var F=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","insertOrderedList","insertUnorderedList","indent","outdent","formatBlock","removeFormat","backColor","foreColor","insertHorizontalRule","fontName"];for(var A=0,z=F.length;A<z;A++){this[F[A]]=(function(G){return function(H,I){C(H);document.execCommand(G,false,I)}})(F[A])}var E=function(I,H,G){C(I);var J=new Array(G+1).join("&nbsp;");H.insertNode(g('<span id="noteTab">'+J+"</span>")[0]);var K=g("#noteTab").removeAttr("id");H=m.create(K[0],1);H.select();t.remove(K[0])};this.tab=function(H,I){var G=m.create();if(G.isCollapsed()&&G.isOnCell()){D.tab(G)}else{E(H,G,I.tabsize)}};this.untab=function(){var G=m.create();if(G.isCollapsed()&&G.isOnCell()){D.tab(G,true)}};this.insertImage=function(G,H){i.createImage(H).then(function(I){C(G);I.css({display:"",width:Math.min(G.width(),I.width())});m.create().insertNode(I[0])}).fail(function(){var I=G.data("callbacks");if(I.onImageUploadError){I.onImageUploadError()}})};this.insertVideo=function(U,K){C(U);var J=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;var O=K.match(J);var R=/\/\/instagram.com\/p\/(.[a-zA-Z0-9]*)/;var Q=K.match(R);var S=/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/;var N=K.match(S);var L=/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/;var M=K.match(L);var I=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/;var T=K.match(I);var P=/\/\/v\.youku\.com\/v_show\/id_(\w+)\.html/;var V=K.match(P);var H;if(O&&O[2].length===11){var G=O[2];H=g("<iframe>").attr("src","//www.youtube.com/embed/"+G).attr("width","640").attr("height","360")}else{if(Q&&Q[0].length){H=g("<iframe>").attr("src",Q[0]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true")}else{if(N&&N[0].length){H=g("<iframe>").attr("src",N[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed")}else{if(M&&M[3].length){H=g("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("src","//player.vimeo.com/video/"+M[3]).attr("width","640").attr("height","360")}else{if(T&&T[2].length){H=g("<iframe>").attr("src","//www.dailymotion.com/embed/video/"+T[2]).attr("width","640").attr("height","360")}else{if(V&&V[1].length){H=g("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+V[1])}else{}}}}}}if(H){H.attr("frameborder",0);m.create().insertNode(H[0])}};this.formatBlock=function(H,G){C(H);G=b.isMSIE?"<"+G+">":G;document.execCommand("FormatBlock",false,G)};this.formatPara=function(G){this.formatBlock(G,"P")};for(var A=1;A<=6;A++){this["formatH"+A]=function(G){return function(H){this.formatBlock(H,"H"+G)}}(A)}this.fontSize=function(G,H){C(G);document.execCommand("fontSize",false,3);if(b.isFF){G.find("font[size=3]").removeAttr("size").css("font-size",H+"px")}else{G.find("span").filter(function(){return this.style.fontSize==="medium"}).css("font-size",H+"px")}};this.lineHeight=function(G,H){C(G);B.stylePara(m.create(),{lineHeight:H})};this.unlink=function(H){var G=m.create();if(G.isOnAnchor()){C(H);var I=t.ancestor(G.sc,t.isAnchor);G=m.createFromNode(I);G.select();document.execCommand("unlink")}};this.createLink=function(J,N,M){var H=N.url;var L=N.text;var G=N.newWindow;var I=N.range;C(J);if(M.onCreateLink){H=M.onCreateLink(H)}I=I.deleteContents();var K=I.insertNode(g("<A>"+L+"</A>")[0]);g(K).attr({href:H,target:G?"_blank":""});I=m.createFromNode(K);I.select()};this.getLinkInfo=function(H){H.focus();var G=m.create().expand(t.isAnchor);var I=g(w.head(G.nodes(t.isAnchor)));return{range:G,text:G.toString(),isNewWindow:I.length?I.attr("target")==="_blank":true,url:I.length?I.attr("href"):""}};this.getVideoInfo=function(H){H.focus();var G=m.create();if(G.isOnAnchor()){var I=t.ancestor(G.sc,t.isAnchor);G=m.createFromNode(I)}return{text:G.toString()}};this.color=function(H,I){var K=JSON.parse(I);var J=K.foreColor,G=K.backColor;C(H);if(J){document.execCommand("foreColor",false,J)}if(G){document.execCommand("backColor",false,G)}};this.insertTable=function(H,G){C(H);var I=G.split("x");m.create().insertNode(D.createTable(I[0],I[1]))};this.floatMe=function(H,I,G){C(H);G.css("float",I)};this.resize=function(H,I,G){C(H);G.css({width:H.width()*I+"px",height:""})};this.resizeTo=function(L,H,I){var G;if(I){var K=L.y/L.x;var J=H.data("ratio");G={width:J>K?L.x:L.y/J,height:J>K?L.x*J:L.y}}else{G={width:L.x,height:L.y}}H.css(G)};this.removeMedia=function(H,I,G){C(H);G.detach()}};var d=function(){var B=[],C=[];var A=function(E){var F=E[0],D=m.create();return{contents:E.html(),bookmark:D.bookmark(F),scrollTop:E.scrollTop()}};var z=function(D,E){D.html(E.contents).scrollTop(E.scrollTop);m.createFromBookmark(D[0],E.bookmark).select()};this.undo=function(D){var E=A(D);if(!B.length){return}z(D,B.pop());C.push(E)};this.redo=function(D){var E=A(D);if(!C.length){return}z(D,C.pop());B.push(E)};this.recordUndo=function(D){C=[];B.push(A(D))}};var l=function(){this.update=function(G,z){var F=function(I,H){I.find(".dropdown-menu li a").each(function(){var J=(g(this).data("value")+"")===(H+"");this.className=J?"checked":""})};var E=function(J,H){var I=G.find(J);I.toggleClass("active",H())};var C=G.find(".note-fontname");if(C.length){var A=z["font-family"];if(!!A){A=w.head(A.split(","));A=A.replace(/\'/g,"");C.find(".note-current-fontname").text(A);F(C,A)}}var D=G.find(".note-fontsize");D.find(".note-current-fontsize").text(z["font-size"]);F(D,parseFloat(z["font-size"]));var B=G.find(".note-height");F(B,parseFloat(z["line-height"]));E('button[data-event="bold"]',function(){return z["font-bold"]==="bold"});E('button[data-event="italic"]',function(){return z["font-italic"]==="italic"});E('button[data-event="underline"]',function(){return z["font-underline"]==="underline"});E('button[data-event="strikethrough"]',function(){return z["font-strikethrough"]==="strikethrough"});E('button[data-event="superscript"]',function(){return z["font-superscript"]==="superscript"});E('button[data-event="subscript"]',function(){return z["font-subscript"]==="subscript"});E('button[data-event="justifyLeft"]',function(){return z["text-align"]==="left"||z["text-align"]==="start"});E('button[data-event="justifyCenter"]',function(){return z["text-align"]==="center"});E('button[data-event="justifyRight"]',function(){return z["text-align"]==="right"});E('button[data-event="justifyFull"]',function(){return z["text-align"]==="justify"});E('button[data-event="insertUnorderedList"]',function(){return z["list-style"]==="unordered"});E('button[data-event="insertOrderedList"]',function(){return z["list-style"]==="ordered"})};this.updateRecentColor=function(B,D,F){var E=g(B).closest(".note-color");var z=E.find(".note-recent-color");var C=JSON.parse(z.attr("data-value"));C[D]=F;z.attr("data-value",JSON.stringify(C));var A=D==="backColor"?"background-color":"color";z.find("i").css(A,F)}};var c=function(){var z=new l();this.update=function(B,A){z.update(B,A)};this.updateRecentColor=function(A,B,C){z.updateRecentColor(A,B,C)};this.activate=function(A){A.find("button").not('button[data-event="codeview"]').removeClass("disabled")};this.deactivate=function(A){A.find("button").not('button[data-event="codeview"]').addClass("disabled")};this.updateFullscreen=function(C,B){var A=C.find('button[data-event="fullscreen"]');A.toggleClass("active",B)};this.updateCodeview=function(C,A){var B=C.find('button[data-event="codeview"]');B.toggleClass("active",A)}};var v=function(){var A=new l();var z=function(G,F){var E=g(G);var H=F?E.offset():E.position();var D=E.outerHeight(true);return{left:H.left,top:H.top+D}};var C=function(D,E){D.css({display:"block",left:E.left,top:E.top})};var B=20;this.update=function(G,K,F){A.update(G,K);var H=G.find(".note-link-popover");if(K.anchor){var L=H.find("a");var E=g(K.anchor).attr("href");L.attr("href",E).html(E);C(H,z(K.anchor,F))}else{H.hide()}var D=G.find(".note-image-popover");if(K.image){C(D,z(K.image,F))}else{D.hide()}var I=G.find(".note-air-popover");if(F&&!K.range.isCollapsed()){var J=j.rect2bnd(w.last(K.range.getClientRects()));C(I,{left:Math.max(J.left+J.width/2-B,0),top:J.top+J.height})}else{I.hide()}};this.updateRecentColor=function(D,E,F){A.updateRecentColor(D,E,F)};this.hide=function(D){D.children().hide()}};var u=function(){this.update=function(G,B,E){var A=G.find(".note-control-selection");if(B.image){var D=g(B.image);var F=E?D.offset():D.position();var z={w:D.outerWidth(true),h:D.outerHeight(true)};A.css({display:"block",left:F.left,top:F.top,width:z.w,height:z.h}).data("target",B.image);var C=z.w+"x"+z.h;A.find(".note-control-selection-info").text(C)}else{A.hide()}};this.hide=function(z){z.children().hide()}};var h=function(){var z=function(B,A){B.toggleClass("disabled",!A);B.attr("disabled",!A)};this.showImageDialog=function(A,B){return g.Deferred(function(E){var G=B.find(".note-image-dialog");var F=B.find(".note-image-input"),C=B.find(".note-image-url"),D=B.find(".note-image-btn");G.one("shown.bs.modal",function(){F.replaceWith(F.clone().on("change",function(){E.resolve(this.files);G.modal("hide")}));D.click(function(H){H.preventDefault();E.resolve(C.val());G.modal("hide")});C.on("keyup paste",function(I){var H;if(I.type==="paste"){H=I.originalEvent.clipboardData.getData("text")}else{H=C.val()}z(D,H)}).val("").trigger("focus")}).one("hidden.bs.modal",function(){F.off("change");C.off("keyup paste");D.off("click");if(E.state()==="pending"){E.reject()}}).modal("show")})};this.showVideoDialog=function(A,B,C){return g.Deferred(function(E){var D=B.find(".note-video-dialog");var F=D.find(".note-video-url"),G=D.find(".note-video-btn");D.one("shown.bs.modal",function(){F.val(C.text).keyup(function(){z(G,F.val())}).trigger("keyup").trigger("focus");G.click(function(H){H.preventDefault();E.resolve(F.val());D.modal("hide")})}).one("hidden.bs.modal",function(){F.off("keyup");G.off("click");if(E.state()==="pending"){E.reject()}}).modal("show")})};this.showLinkDialog=function(A,C,B){return g.Deferred(function(G){var H=C.find(".note-link-dialog");var F=H.find(".note-link-text"),I=H.find(".note-link-url"),E=H.find(".note-link-btn"),D=H.find("input[type=checkbox]");H.one("shown.bs.modal",function(){F.val(B.text);F.keyup(function(){B.text=F.val()});if(!B.url){B.url=B.text;z(E,B.text)}I.keyup(function(){z(E,I.val());if(!B.text){F.val(I.val())}}).val(B.url).trigger("focus").trigger("select");D.prop("checked",B.newWindow);E.one("click",function(J){J.preventDefault();G.resolve({range:B.range,url:I.val(),text:F.val(),newWindow:D.is(":checked")});H.modal("hide")})}).one("hidden.bs.modal",function(){F.off("keyup");I.off("keyup");E.off("click");if(G.state()==="pending"){G.reject()}}).modal("show")}).promise()};this.showHelpDialog=function(A,B){return g.Deferred(function(C){var D=B.find(".note-help-dialog");D.one("hidden.bs.modal",function(){C.resolve()}).modal("show")}).promise()}};var r;if(b.hasCodeMirror){if(b.isSupportAmd){require(["CodeMirror"],function(z){r=z})}else{r=window.CodeMirror}}var k=function(){var J=g(window);var V=g(document);var S=g("html, body");var B=new p();var I=new c(),D=new v();var U=new u(),R=new h();var C=function(X){var W=g(X).closest(".note-editor, .note-air-editor, .note-air-layout");if(!W.length){return null}var Y;if(W.is(".note-editor, .note-air-editor")){Y=W}else{Y=g("#note-editor-"+w.last(W.attr("id").split("-")))}return t.buildLayoutInfo(Y)};var z=function(W,Y){B.restoreRange(W);var X=W.data("callbacks");if(X.onImageUpload){X.onImageUpload(Y,B,W)}else{g.each(Y,function(Z,aa){i.readFileAsDataURL(aa).then(function(ab){B.insertImage(W,ab)}).fail(function(){if(X.onImageUploadError){X.onImageUploadError()}})})}};var F={showLinkDialog:function(ab){var aa=ab.editor(),Z=ab.dialog(),W=ab.editable(),Y=B.getLinkInfo(W);var X=aa.data("options");B.saveRange(W);R.showLinkDialog(W,Z,Y).then(function(ac){B.restoreRange(W);B.createLink(W,ac,X);D.hide(ab.popover())}).fail(function(){B.restoreRange(W)})},showImageDialog:function(Y){var X=Y.dialog(),W=Y.editable();B.saveRange(W);R.showImageDialog(W,X).then(function(Z){B.restoreRange(W);if(typeof Z==="string"){B.insertImage(W,Z)}else{z(W,Z)}}).fail(function(){B.restoreRange(W)})},showVideoDialog:function(Z){var X=Z.dialog(),W=Z.editable(),Y=B.getVideoInfo(W);B.saveRange(W);R.showVideoDialog(W,X,Y).then(function(aa){B.restoreRange(W);B.insertVideo(W,aa)}).fail(function(){B.restoreRange(W)})},showHelpDialog:function(Y){var X=Y.dialog(),W=Y.editable();B.saveRange(W);R.showHelpDialog(W,X).then(function(){B.restoreRange(W)})},fullscreen:function(ad){var ac=ad.editor(),aa=ad.toolbar(),X=ad.editable(),W=ad.codable();var Z=ac.data("options");var Y=function(ae){ac.css("width",ae.w);X.css("height",ae.h);W.css("height",ae.h);if(W.data("cmeditor")){W.data("cmeditor").setsize(null,ae.h)}};ac.toggleClass("fullscreen");var ab=ac.hasClass("fullscreen");if(ab){X.data("orgheight",X.css("height"));J.on("resize",function(){Y({w:J.width(),h:J.height()-aa.outerHeight()})}).trigger("resize");S.css("overflow","hidden")}else{J.off("resize");Y({w:Z.width||"",h:X.data("orgheight")});S.css("overflow","visible")}I.updateFullscreen(aa,ab)},codeview:function(W){var Y=W.editor(),Z=W.toolbar(),ae=W.editable(),ac=W.codable(),ab=W.popover();var af=Y.data("options");var X,aa;Y.toggleClass("codeview");var ad=Y.hasClass("codeview");if(ad){ac.val(ae.html());ac.height(ae.height());I.deactivate(Z);D.hide(ab);ac.focus();if(b.hasCodeMirror){X=r.fromTextArea(ac[0],af.codemirror);if(af.codemirror.tern){aa=new r.TernServer(af.codemirror.tern);X.ternServer=aa;X.on("cursorActivity",function(ag){aa.updateArgHints(ag)})}X.setSize(null,ae.outerHeight());if(af.codemirror.autoFormatOnStart&&X.autoFormatRange){X.autoFormatRange({line:0,ch:0},{line:X.lineCount(),ch:X.getTextArea().value.length})}ac.data("cmEditor",X)}}else{if(b.hasCodeMirror){X=ac.data("cmEditor");ac.val(X.getValue());X.toTextArea()}ae.html(ac.val()||t.emptyPara);ae.height(af.height?ac.height():"auto");I.activate(Z);ae.focus()}I.updateCodeview(W.toolbar(),ad)}};var H=function(W){if(t.isImg(W.target)){W.preventDefault()}};var K=function(W){setTimeout(function(){var Z=C(W.currentTarget||W.target);var X=B.currentStyle(W.target);if(!X){return}var Y=Z.editor().data("options").airMode;if(!Y){I.update(Z.toolbar(),X)}D.update(Z.popover(),X,Y);U.update(Z.handle(),X,Y)},0)};var Q=function(W){var X=C(W.currentTarget||W.target);D.hide(X.popover());U.hide(X.handle())};var L=function(Y){var aa=Y.originalEvent.clipboardData;if(!aa||!aa.items||!aa.items.length){return}var Z=C(Y.currentTarget||Y.target);var X=w.head(aa.items);var W=X.kind==="file"&&X.type.indexOf("image/")!==-1;if(W){z(Z.editable(),[X.getAsFile()])}};var E=function(X){if(t.isControlSizing(X.target)){X.preventDefault();X.stopPropagation();var W=C(X.target),Y=W.handle(),af=W.popover(),ag=W.editable(),Z=W.editor();var ab=Y.find(".note-control-selection").data("target"),ac=g(ab),ae=ac.offset(),aa=V.scrollTop();var ad=Z.data("options").airMode;V.on("mousemove",function(ah){B.resizeTo({x:ah.clientX-ae.left,y:ah.clientY-(ae.top-aa)},ac,!ah.shiftKey);U.update(Y,{image:ab},ad);D.update(af,{image:ab},ad)}).one("mouseup",function(){V.off("mousemove")});if(!ac.data("ratio")){ac.data("ratio",ac.height()/ac.width())}B.recordUndo(ag)}};var P=function(X){var W=g(X.target).closest("[data-event]");if(W.length){X.preventDefault()}};var T=function(X){var ac=g(X.target).closest("[data-event]");if(ac.length){var Y=ac.attr("data-event"),ad=ac.attr("data-value");var W=C(X.target);X.preventDefault();var aa;if(g.inArray(Y,["resize","floatMe","removeMedia"])!==-1){var ab=W.handle().find(".note-control-selection");aa=g(ab.data("target"))}if(B[Y]){var ae=W.editable();ae.trigger("focus");B[Y](ae,ad,aa)}else{if(F[Y]){F[Y].call(this,W)}}if(g.inArray(Y,["backColor","foreColor"])!==-1){var af=W.editor().data("options",af);var Z=af.airMode?D:I;Z.updateRecentColor(w.head(ac),Y,ad)}K(X)}};var N=24;var G=function(Y){Y.preventDefault();Y.stopPropagation();var W=C(Y.target).editable();var Z=W.offset().top-V.scrollTop();var aa=C(Y.currentTarget||Y.target);var X=aa.editor().data("options");V.on("mousemove",function(ac){var ab=ac.clientY-(Z+N);ab=(X.minHeight>0)?Math.max(ab,X.minHeight):ab;ab=(X.maxHeight>0)?Math.min(ab,X.maxHeight):ab;W.height(ab)}).one("mouseup",function(){V.off("mousemove")})};var M=18;var O=function(X,af){var Z=g(X.target.parentNode);var Y=Z.next();var ae=Z.find(".note-dimension-picker-mousecatcher");var aa=Z.find(".note-dimension-picker-highlighted");var ab=Z.find(".note-dimension-picker-unhighlighted");var ad;if(X.offsetX===undefined){var W=g(X.target).offset();ad={x:X.pageX-W.left,y:X.pageY-W.top}}else{ad={x:X.offsetX,y:X.offsetY}}var ac={c:Math.ceil(ad.x/M)||1,r:Math.ceil(ad.y/M)||1};aa.css({width:ac.c+"em",height:ac.r+"em"});ae.attr("data-value",ac.c+"x"+ac.r);if(3<ac.c&&ac.c<af.insertTableMaxSize.col){ab.css({width:ac.c+1+"em"})}if(3<ac.r&&ac.r<af.insertTableMaxSize.row){ab.css({height:ac.r+1+"em"})}Y.html(ac.c+" x "+ac.r)};var A=function(Z){var X=g(),Y=Z.dropzone,W=Z.dropzone.find(".note-dropzone-message");V.on("dragenter",function(ab){var aa=Z.editor.hasClass("codeview");if(!aa&&!X.length){Z.editor.addClass("dragover");Y.width(Z.editor.width());Y.height(Z.editor.height());W.text("Drag Image Here")}X=X.add(ab.target)}).on("dragleave",function(aa){X=X.not(aa.target);if(!X.length){Z.editor.removeClass("dragover")}}).on("drop",function(){X=g();Z.editor.removeClass("dragover")});Y.on("dragenter",function(){Y.addClass("hover");W.text("Drop Image")}).on("dragleave",function(){Y.removeClass("hover");W.text("Drag Image Here")});Y.on("drop",function(aa){aa.preventDefault();var ab=aa.originalEvent.dataTransfer;if(ab&&ab.files){var ac=C(aa.currentTarget||aa.target);ac.editable().focus();z(ac.editable(),ab.files)}}).on("dragover",false)};this.bindKeyMap=function(Z,Y){var X=Z.editor;var W=Z.editable;Z=C(W);W.on("keydown",function(ac){var ab=[];if(ac.metaKey){ab.push("CMD")}if(ac.ctrlKey&&!ac.altKey){ab.push("CTRL")}if(ac.shiftKey){ab.push("SHIFT")}var aa=y.nameFromCode[ac.keyCode];if(aa){ab.push(aa)}var ad=Y[ab.join("+")];if(ad){ac.preventDefault();if(B[ad]){B[ad](W,X.data("options"))}else{if(F[ad]){F[ad].call(this,Z)}}}else{if(y.isEdit(ac.keyCode)){B.recordUndo(W)}}})};this.attach=function(ab,X){this.bindKeyMap(ab,X.keyMap[b.isMac?"mac":"pc"]);ab.editable.on("mousedown",H);ab.editable.on("keyup mouseup",K);ab.editable.on("scroll",Q);ab.editable.on("paste",L);ab.handle.on("mousedown",E);ab.popover.on("click",T);ab.popover.on("mousedown",P);if(!X.airMode){if(!X.disableDragAndDrop){A(ab)}ab.toolbar.on("click",T);ab.toolbar.on("mousedown",P);if(!X.disableResizeEditor){ab.statusbar.on("mousedown",G)}}var W=X.airMode?ab.popover:ab.toolbar;var aa=W.find(".note-dimension-picker-mousecatcher");aa.css({width:X.insertTableMaxSize.col+"em",height:X.insertTableMaxSize.row+"em"}).on("mousemove",function(ac){O(ac,X)});ab.editor.data("options",X);if(X.styleWithSpan&&!b.isMSIE){setTimeout(function(){document.execCommand("styleWithCSS",0,true)},0)}ab.editable.data("NoteHistory",new d());if(X.onenter){ab.editable.keypress(function(ac){if(ac.keyCode===y.ENTER){X.onenter(ac)}})}if(X.onfocus){ab.editable.focus(X.onfocus)}if(X.onblur){ab.editable.blur(X.onblur)}if(X.onkeyup){ab.editable.keyup(X.onkeyup)}if(X.onkeydown){ab.editable.keydown(X.onkeydown)}if(X.onpaste){ab.editable.on("paste",X.onpaste)}if(X.onToolbarClick){ab.toolbar.click(X.onToolbarClick)}if(X.onChange){var Y=function(){X.onChange(ab.editable,ab.editable.html())};if(b.isMSIE){var Z="DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted";ab.editable.on(Z,Y)}else{ab.editable.on("input",Y)}}ab.editable.data("callbacks",{onAutoSave:X.onAutoSave,onImageUpload:X.onImageUpload,onImageUploadError:X.onImageUploadError,onFileUpload:X.onFileUpload,onFileUploadError:X.onFileUpload})};this.dettach=function(X,W){X.editable.off();X.popover.off();X.handle.off();X.dialog.off();if(!W.airMode){X.dropzone.off();X.toolbar.off();X.statusbar.off()}}};var q=function(){var B=function(W,T){var V=T.event;var X=T.value;var Y=T.title;var U=T.className;var Z=T.dropdown;return'<button type="button" class="btn btn-default btn-sm btn-small'+(U?" "+U:"")+(Z?" dropdown-toggle":"")+'"'+(Z?' data-toggle="dropdown"':"")+(Y?' title="'+Y+'"':"")+(V?' data-event="'+V+'"':"")+(X?" data-value='"+X+"'":"")+' tabindex="-1">'+W+(Z?' <span class="caret"></span>':"")+"</button>"+(Z||"")};var F=function(U,T){var V='<i class="'+U+'"></i>';return B(V,T)};var K=function(T,U){return'<div class="'+T+' popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content">'+U+"</div></div>"};var S=function(U,V,T,W){return'<div class="'+U+' modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content">'+(V?'<div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4 class="modal-title">'+V+"</h4></div>":"")+'<form class="note-modal-form"><div class="modal-body"><div class="row-fluid">'+T+"</div></div>"+(W?'<div class="modal-footer">'+W+"</div>":"")+"</form></div></div></div>"};var O={picture:function(T){return F("fa fa-picture-o icon-picture",{event:"showImageDialog",title:T.image.image})},link:function(T){return F("fa fa-link icon-link",{event:"showLinkDialog",title:T.link.link})},video:function(T){return F("fa fa-youtube-play icon-play",{event:"showVideoDialog",title:T.video.video})},table:function(T){var U='<ul class="dropdown-menu"><div class="note-dimension-picker"><div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div><div class="note-dimension-picker-highlighted"></div><div class="note-dimension-picker-unhighlighted"></div></div><div class="note-dimension-display"> 1 x 1 </div></ul>';return F("fa fa-table icon-table",{title:T.table.table,dropdown:U})},style:function(V,U){var T=U.styleTags.reduce(function(X,W){var Y=V.style[W==="p"?"normal":W];return X+'<li><a data-event="formatBlock" href="#" data-value="'+W+'">'+((W==="p"||W==="pre")?Y:"<"+W+">"+Y+"</"+W+">")+"</a></li>"},"");return F("fa fa-magic icon-magic",{title:V.style.style,dropdown:'<ul class="dropdown-menu">'+T+"</ul>"})},fontname:function(W,U){var T=U.fontNames.reduce(function(Y,X){if(!b.isFontInstalled(X)){return Y}return Y+'<li><a data-event="fontName" href="#" data-value="'+X+'"><i class="fa fa-check icon-ok"></i> '+X+"</a></li>"},"");var V='<span class="note-current-fontname">'+U.defaultFontName+"</span>";return B(V,{title:W.font.name,dropdown:'<ul class="dropdown-menu">'+T+"</ul>"})},fontsize:function(W,U){var T=U.fontSizes.reduce(function(Y,X){return Y+'<li><a data-event="fontSize" href="#" data-value="'+X+'"><i class="fa fa-check icon-ok"></i> '+X+"</a></li>"},"");var V='<span class="note-current-fontsize">11</span>';return B(V,{title:W.font.size,dropdown:'<ul class="dropdown-menu">'+T+"</ul>"})},color:function(W){var V='<i class="fa fa-font icon-font" style="color:black;background-color:yellow;"></i>';var T=B(V,{className:"note-recent-color",title:W.color.recent,event:"color",value:'{"backColor":"yellow"}'});var X='<ul class="dropdown-menu"><li><div class="btn-group"><div class="note-palette-title">'+W.color.background+'</div><div class="note-color-reset" data-event="backColor" data-value="inherit" title="'+W.color.transparent+'">'+W.color.setTransparent+'</div><div class="note-color-palette" data-target-event="backColor"></div></div><div class="btn-group"><div class="note-palette-title">'+W.color.foreground+'</div><div class="note-color-reset" data-event="foreColor" data-value="inherit" title="'+W.color.reset+'">'+W.color.resetToDefault+'</div><div class="note-color-palette" data-target-event="foreColor"></div></div></li></ul>';var U=B("",{title:W.color.more,dropdown:X});return T+U},bold:function(T){return F("fa fa-bold icon-bold",{event:"bold",title:T.font.bold})},italic:function(T){return F("fa fa-italic icon-italic",{event:"italic",title:T.font.italic})},underline:function(T){return F("fa fa-underline icon-underline",{event:"underline",title:T.font.underline})},strikethrough:function(T){return F("fa fa-strikethrough icon-strikethrough",{event:"strikethrough",title:T.font.strikethrough})},superscript:function(T){return F("fa fa-superscript icon-superscript",{event:"superscript",title:T.font.superscript})},subscript:function(T){return F("fa fa-subscript icon-subscript",{event:"subscript",title:T.font.subscript})},clear:function(T){return F("fa fa-eraser icon-eraser",{event:"removeFormat",title:T.font.clear})},ul:function(T){return F("fa fa-list-ul icon-list-ul",{event:"insertUnorderedList",title:T.lists.unordered})},ol:function(T){return F("fa fa-list-ol icon-list-ol",{event:"insertOrderedList",title:T.lists.ordered})},paragraph:function(Z){var V=F("fa fa-align-left icon-align-left",{title:Z.paragraph.left,event:"justifyLeft"});var Y=F("fa fa-align-center icon-align-center",{title:Z.paragraph.center,event:"justifyCenter"});var W=F("fa fa-align-right icon-align-right",{title:Z.paragraph.right,event:"justifyRight"});var X=F("fa fa-align-justify icon-align-justify",{title:Z.paragraph.justify,event:"justifyFull"});var U=F("fa fa-outdent icon-indent-left",{title:Z.paragraph.outdent,event:"outdent"});var T=F("fa fa-indent icon-indent-right",{title:Z.paragraph.indent,event:"indent"});var aa='<div class="dropdown-menu"><div class="note-align btn-group">'+V+Y+W+X+'</div><div class="note-list btn-group">'+T+U+"</div></div>";return F("fa fa-align-left icon-align-left",{title:Z.paragraph.paragraph,dropdown:aa})},height:function(V,U){var T=U.lineHeights.reduce(function(X,W){return X+'<li><a data-event="lineHeight" href="#" data-value="'+parseFloat(W)+'"><i class="fa fa-check icon-ok"></i> '+W+"</a></li>"},"");return F("fa fa-text-height icon-text-height",{title:V.font.height,dropdown:'<ul class="dropdown-menu">'+T+"</ul>"})},help:function(T){return F("fa fa-question icon-question",{event:"showHelpDialog",title:T.options.help})},fullscreen:function(T){return F("fa fa-arrows-alt icon-fullscreen",{event:"fullscreen",title:T.options.fullscreen})},codeview:function(T){return F("fa fa-code icon-code",{event:"codeview",title:T.options.codeview})},undo:function(T){return F("fa fa-undo icon-undo",{event:"undo",title:T.history.undo})},redo:function(T){return F("fa fa-repeat icon-repeat",{event:"redo",title:T.history.redo})},hr:function(T){return F("fa fa-minus icon-hr",{event:"insertHorizontalRule",title:T.hr.insert})}};var C=function(X,T){var W=function(){var Y=F("fa fa-edit icon-edit",{title:X.link.edit,event:"showLinkDialog"});var aa=F("fa fa-unlink icon-unlink",{title:X.link.unlink,event:"unlink"});var Z='<a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;<div class="note-insert btn-group">'+Y+aa+"</div>";return K("note-link-popover",Z)};var V=function(){var af=B('<span class="note-fontsize-10">100%</span>',{title:X.image.resizeFull,event:"resize",value:"1"});var ab=B('<span class="note-fontsize-10">50%</span>',{title:X.image.resizeHalf,event:"resize",value:"0.5"});var ae=B('<span class="note-fontsize-10">25%</span>',{title:X.image.resizeQuarter,event:"resize",value:"0.25"});var Y=F("fa fa-align-left icon-align-left",{title:X.image.floatLeft,event:"floatMe",value:"left"});var Z=F("fa fa-align-right icon-align-right",{title:X.image.floatRight,event:"floatMe",value:"right"});var aa=F("fa fa-align-justify icon-align-justify",{title:X.image.floatNone,event:"floatMe",value:"none"});var ad=F("fa fa-trash-o icon-trash",{title:X.image.remove,event:"removeMedia",value:"none"});var ac='<div class="btn-group">'+af+ab+ae+'</div><div class="btn-group">'+Y+Z+aa+'</div><div class="btn-group">'+ad+"</div>";return K("note-image-popover",ac)};var U=function(){var ab="";for(var Z=0,ad=T.airPopover.length;Z<ad;Z++){var ac=T.airPopover[Z];ab+='<div class="note-'+ac[0]+' btn-group">';for(var aa=0,Y=ac[1].length;aa<Y;aa++){ab+=O[ac[1][aa]](X,T)}ab+="</div>"}return K("note-air-popover",ab)};return'<div class="note-popover">'+W()+V()+(T.airMode?U():"")+"</div>"};var R=function(){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"></div><div class="note-control-holder note-control-nw"></div><div class="note-control-holder note-control-ne"></div><div class="note-control-holder note-control-sw"></div><div class="note-control-sizing note-control-se"></div><div class="note-control-selection-info"></div></div></div>'};var I=function(U,T){return'<table class="note-shortcut"><thead><tr><th></th><th>'+U+"</th></tr></thead><tbody>"+T+"</tbody></table>"};var z=function(U){var T="<tr><td>⌘ + B</td><td>"+U.font.bold+"</td></tr><tr><td>⌘ + I</td><td>"+U.font.italic+"</td></tr><tr><td>⌘ + U</td><td>"+U.font.underline+"</td></tr><tr><td>⌘ + ⇧ + S</td><td>"+U.font.strikethrough+"</td></tr><tr><td>⌘ + \\</td><td>"+U.font.clear+"</td></tr>";return I(U.shortcut.textFormatting,T)};var Q=function(U){var T="<tr><td>⌘ + Z</td><td>"+U.history.undo+"</td></tr><tr><td>⌘ + ⇧ + Z</td><td>"+U.history.redo+"</td></tr><tr><td>⌘ + ]</td><td>"+U.paragraph.indent+"</td></tr><tr><td>⌘ + [</td><td>"+U.paragraph.outdent+"</td></tr><tr><td>⌘ + ENTER</td><td>"+U.hr.insert+"</td></tr>";return I(U.shortcut.action,T)};var L=function(U){var T="<tr><td>⌘ + ⇧ + L</td><td>"+U.paragraph.left+"</td></tr><tr><td>⌘ + ⇧ + E</td><td>"+U.paragraph.center+"</td></tr><tr><td>⌘ + ⇧ + R</td><td>"+U.paragraph.right+"</td></tr><tr><td>⌘ + ⇧ + J</td><td>"+U.paragraph.justify+"</td></tr><tr><td>⌘ + ⇧ + NUM7</td><td>"+U.lists.ordered+"</td></tr><tr><td>⌘ + ⇧ + NUM8</td><td>"+U.lists.unordered+"</td></tr>";return I(U.shortcut.paragraphFormatting,T)};var N=function(U){var T="<tr><td>⌘ + NUM0</td><td>"+U.style.normal+"</td></tr><tr><td>⌘ + NUM1</td><td>"+U.style.h1+"</td></tr><tr><td>⌘ + NUM2</td><td>"+U.style.h2+"</td></tr><tr><td>⌘ + NUM3</td><td>"+U.style.h3+"</td></tr><tr><td>⌘ + NUM4</td><td>"+U.style.h4+"</td></tr><tr><td>⌘ + NUM5</td><td>"+U.style.h5+"</td></tr><tr><td>⌘ + NUM6</td><td>"+U.style.h6+"</td></tr>";return I(U.shortcut.documentStyle,T)};var D=function(X,U){var W=U.extraKeys;var T="";for(var V in W){if(W.hasOwnProperty(V)){T+="<tr><td>"+V+"</td><td>"+W[V]+"</td></tr>"}}return I(X.shortcut.extraKeys,T)};var P=function(V,T){var U='<table class="note-shortcut-layout"><tbody><tr><td>'+Q(V,T)+"</td><td>"+z(V,T)+"</td></tr><tr><td>"+N(V,T)+"</td><td>"+L(V,T)+"</td></tr>";if(T.extraKeys){U+='<tr><td colspan="2">'+D(V,T)+"</td></tr>"}U+="</tbody</table>";return U};var J=function(T){return T.replace(/⌘/g,"Ctrl").replace(/⇧/g,"Shift")};var A=function(Y,T){var W=function(){var Z="<h5>"+Y.image.selectFromFiles+'</h5><input class="note-image-input" type="file" name="files" accept="image/*" /><h5>'+Y.image.url+'</h5><input class="note-image-url form-control span12" type="text" />';var aa='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+Y.image.insert+"</button>";return S("note-image-dialog",Y.image.insert,Z,aa)};var U=function(){var Z='<div class="form-group"><label>'+Y.link.textToDisplay+'</label><input class="note-link-text form-control span12" type="text" /></div><div class="form-group"><label>'+Y.link.url+'</label><input class="note-link-url form-control span12" type="text" /></div>'+(!T.disableLinkTarget?'<div class="checkbox"><label><input type="checkbox" checked> '+Y.link.openInNewWindow+"</label></div>":"");var aa='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+Y.link.insert+"</button>";return S("note-link-dialog",Y.link.insert,Z,aa)};var V=function(){var Z='<div class="form-group"><label>'+Y.video.url+'</label>&nbsp;<small class="text-muted">'+Y.video.providers+'</small><input class="note-video-url form-control span12" type="text" /></div>';var aa='<button href="#" class="btn btn-primary note-video-btn disabled" disabled>'+Y.video.insert+"</button>";return S("note-video-dialog",Y.video.insert,Z,aa)};var X=function(){var Z='<a class="modal-close pull-right" aria-hidden="true" tabindex="-1">'+Y.shortcut.close+'</a><div class="title">'+Y.shortcut.shortcuts+"</div>"+(b.isMac?P(Y,T):J(P(Y,T)))+'<p class="text-center"><a href="//hackerwins.github.io/summernote/" target="_blank">Summernote 0.5.3</a> · <a href="//github.com/HackerWins/summernote" target="_blank">Project</a> · <a href="//github.com/HackerWins/summernote/issues" target="_blank">Issues</a></p>';return S("note-help-dialog","",Z,"")};return'<div class="note-dialog">'+W()+U()+V()+X()+"</div>"};var H=function(){return'<div class="note-resizebar"><div class="note-icon-bar"></div><div class="note-icon-bar"></div><div class="note-icon-bar"></div></div>'};var G=function(T){if(b.isMac){T=T.replace("CMD","⌘").replace("SHIFT","⇧")}return T.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")};var M=function(W,X,T){var V=j.invertObject(X);var U=W.find("button");U.each(function(Z,ab){var aa=g(ab);var Y=V[aa.data("event")];if(Y){aa.attr("title",function(ad,ac){return ac+" ("+G(Y)+")"})}}).tooltip({container:"body",trigger:"hover",placement:T||"top"}).on("click",function(){g(this).tooltip("hide")})};var E=function(V,U){var T=U.colors;V.find(".note-color-palette").each(function(){var ad=g(this),W=ad.attr("data-target-event");var ab=[];for(var af=0,X=T.length;af<X;af++){var ae=T[af];var Z=[];for(var Y=0,ac=ae.length;Y<ac;Y++){var aa=ae[Y];Z.push(['<button type="button" class="note-color-btn" style="background-color:',aa,';" data-event="',W,'" data-value="',aa,'" title="',aa,'" data-toggle="button" tabindex="-1"></button>'].join(""))}ab.push('<div class="note-color-row">'+Z.join("")+"</div>")}ad.html(ab.join(""))})};this.createLayoutByAirMode=function(W,ab){var Z=ab.keyMap[b.isMac?"mac":"pc"];var aa=g.summernote.lang[ab.lang];var T=j.uniqueId();W.addClass("note-air-editor note-editable");W.attr({id:"note-editor-"+T,contentEditable:true});var Y=document.body;var X=g(C(aa,ab));X.addClass("note-air-layout");X.attr("id","note-popover-"+T);X.appendTo(Y);M(X,Z);E(X,ab);var U=g(R());U.addClass("note-air-layout");U.attr("id","note-handle-"+T);U.appendTo(Y);var V=g(A(aa,ab));V.addClass("note-air-layout");V.attr("id","note-dialog-"+T);V.find("button.close, a.modal-close").click(function(){g(this).closest(".modal").modal("hide")});V.appendTo(Y)};this.createLayoutByFrame=function(W,aj){var T=g('<div class="note-editor"></div>');if(aj.width){T.width(aj.width)}if(aj.height>0){g('<div class="note-statusbar">'+(aj.disableResizeEditor?"":H())+"</div>").prependTo(T)}var ai=!W.is(":disabled");var ag=g('<div class="note-editable" contentEditable="'+ai+'"></div>').prependTo(T);if(aj.height){ag.height(aj.height)}if(aj.direction){ag.attr("dir",aj.direction)}ag.html(t.html(W)||t.emptyPara);g('<textarea class="note-codable"></textarea>').prependTo(T);var ac=g.summernote.lang[aj.lang];var ae="";for(var af=0,ad=aj.toolbar.length;af<ad;af++){var ah=aj.toolbar[af][0];var Z=aj.toolbar[af][1];ae+='<div class="note-'+ah+' btn-group">';for(var Y=0,ab=Z.length;Y<ab;Y++){if(!g.isFunction(O[Z[Y]])){continue}ae+=O[Z[Y]](ac,aj)}ae+="</div>"}ae='<div class="note-toolbar btn-toolbar">'+ae+"</div>";var V=g(ae).prependTo(T);var aa=aj.keyMap[b.isMac?"mac":"pc"];E(V,aj);M(V,aa,"bottom");var X=g(C(ac,aj)).prependTo(T);E(X,aj);M(X,aa);g(R()).prependTo(T);var U=g(A(ac,aj)).prependTo(T);U.find("button.close, a.modal-close").click(function(){g(this).closest(".modal").modal("hide")});g('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo(T);T.insertAfter(W);W.hide()};this.noteEditorFromHolder=function(T){if(T.hasClass("note-air-editor")){return T}else{if(T.next().hasClass("note-editor")){return T.next()}else{return g()}}};this.createLayout=function(U,T){if(this.noteEditorFromHolder(U).length){return}if(T.airMode){this.createLayoutByAirMode(U,T)}else{this.createLayoutByFrame(U,T)}};this.layoutInfoFromHolder=function(U){var W=this.noteEditorFromHolder(U);if(!W.length){return}var V=t.buildLayoutInfo(W);for(var T in V){if(V.hasOwnProperty(T)){V[T]=V[T].call()}}return V};this.removeLayout=function(U,V,T){if(T.airMode){U.removeClass("note-air-editor note-editable").removeAttr("id contentEditable");V.popover.remove();V.handle.remove();V.dialog.remove()}else{U.html(V.editable.html());V.editor.remove();U.show()}}};g.summernote=g.summernote||{};g.extend(g.summernote,x);var o=new q();var s=new k();g.fn.extend({summernote:function(z){z=g.extend({},g.summernote.options,z);this.each(function(B,C){var D=g(C);o.createLayout(D,z);var E=o.layoutInfoFromHolder(D);s.attach(E,z);if(t.isTextarea(D[0])){D.closest("form").submit(function(){D.val(D.code())})}});if(this.first().length&&z.focus){var A=o.layoutInfoFromHolder(this.first());A.editable.focus()}if(this.length&&z.oninit){z.oninit()}return this},code:function(A){if(A===undefined){var B=this.first();if(!B.length){return}var C=o.layoutInfoFromHolder(B);if(!!(C&&C.editable)){var z=C.editor.hasClass("codeview");if(z&&b.hasCodeMirror){C.codable.data("cmEditor").save()}return z?C.codable.val():C.editable.html()}return t.isTextarea(B[0])?B.val():B.html()}this.each(function(D,E){var F=o.layoutInfoFromHolder(g(E));if(F&&F.editable){F.editable.html(A)}});return this},destroy:function(){this.each(function(z,B){var C=g(B);var D=o.layoutInfoFromHolder(C);if(!D||!D.editable){return}var A=D.editor.data("options");s.dettach(D,A);o.removeLayout(C,D,A)});return this}})}));